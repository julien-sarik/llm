# llm
Based on `https://github.com/ollama/ollama?tab=readme-ov-file`.  
Start the Ollama app within a container:
```
podman run --rm -p 11434:11434 --name ollama -v "$PWD/.ollama":/root/.ollama ollama/ollama:0.4.0
```

Download and run a Llama model within the Ollama app:
```
podman exec -it ollama ollama run llama3.2:1b
```
# embedding model
Inspired from this post: `https://ollama.com/blog/embedding-models`.  
Download `all-minilm` embedding model:
```
podman exec -it ollama ollama pull all-minilm
```

Generate embedding through the REST API:
```
curl http://localhost:11434/api/embeddings -d '{"model": "all-minilm","prompt": "Llamas are members of the camelid family"}'
```
## chromadb
Run ChromaDB embedding server:
```
podman run --rm -p 8000:8000 docker.io/chromadb/chroma:0.5.19.dev30'
```
Chromadb REST API is available at `localhost:8000/docs`.  

Create collection:
```
curl -X 'POST' \
  'http://localhost:8000/api/v1/collections' \
  -H 'Content-Type: application/json' \
  -d '{
  "name": "foo",
  "configuration": {}
}'
```
Insert an embedding for a document:
```
curl -X 'POST' \
  'http://localhost:8000/api/v1/collections/45c8f2f4-b89e-42ee-91aa-bfcb3569efe8/add' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "documents": [
    "swimming is not that hard"
  ],
  "embeddings": [
    [0.3160823881626129,-0.18374517560005188,0.4203367233276367,0.1266750991344452,-0.28012415766716003,-0.21143265068531036,0.32749029994010925,-0.29764324426651,-0.5887020230293274,0.09673631936311722,-0.278433233499527,-0.6142888069152832,-0.19637876749038696,0.8639377355575562,-0.15851347148418427,-0.48104462027549744,-0.09787613898515701,-0.28960293531417847,-0.45948705077171326,0.23228631913661957,-0.3592633605003357,0.40643149614334106,-0.1775456666946411,-0.09384859353303909,-0.00020009279251098633,0.46436360478401184,0.08946524560451508,0.10831094533205032,0.1065921038389206,-0.057653725147247314,-0.45579591393470764,0.43954649567604065,-0.2070087492465973,-0.56361985206604,-0.2791365087032318,0.2833288013935089,-0.11288195103406906,-0.21527333557605743,-0.1220637783408165,-0.05646692216396332,0.06512495875358582,-0.17926855385303497,0.19668087363243103,0.3679259717464447,0.6100661158561707,0.6330380439758301,0.10566741973161697,0.34972167015075684,0.29879480600357056,0.2445078343153,-0.2058238834142685,-0.1381954550743103,-0.05451875180006027,-0.33612194657325745,0.17205752432346344,0.22618162631988525,-0.17584258317947388,0.3131389319896698,0.08994290232658386,-0.08418872207403183,-0.05259935185313225,0.13911713659763336,0.1424780637025833,0.16381219029426575,0.368120014667511,-0.466331422328949,-0.0914989486336708,0.33730262517929077,0.20874446630477905,0.32879677414894104,-0.22972792387008667,0.27558672428131104,-0.12246944010257721,0.228086918592453,0.09577254205942154,-0.49120545387268066,0.11730638891458511,-0.21977631747722626,-0.026491673663258553,0.7027221918106079,-0.10315580666065216,-0.9814758896827698,0.27470046281814575,0.458763062953949,0.0880032479763031,-0.1977621614933014,0.22126543521881104,-0.4106026589870453,-0.2944077253341675,-0.028889670968055725,-0.0732550173997879,-0.3760640025138855,-0.4300897717475891,0.011241372674703598,-0.05719532445073128,0.2600676417350769,-0.39873963594436646,0.2870548963546753,-0.26421672105789185,0.39784255623817444,0.050564803183078766,-0.007107867859303951,0.21578434109687805,0.3596934676170349,0.5538660287857056,-0.5587409138679504,0.6403157711029053,0.2778063118457794,0.370414674282074,0.007344056852161884,-0.35716769099235535,-0.14796167612075806,0.7400789260864258,0.2164745032787323,-0.1940164566040039,0.08911854028701782,-0.22244864702224731,-0.04781819134950638,0.043756306171417236,0.7415041923522949,-0.35231220722198486,-0.13110357522964478,0.06094220280647278,-0.15399831533432007,0.010966598987579346,-0.4616001844406128,0.5228787660598755,-2.742909391531471e-32,0.2354063242673874,-0.04402140527963638,0.19503261148929596,0.035265225917100906,-0.6217049360275269,-0.33834922313690186,-0.02662423998117447,-0.2985967695713043,-0.11893650889396667,-0.30525538325309753,-0.022579923272132874,-0.13753315806388855,-0.27565261721611023,-0.3798940181732178,0.7034103274345398,-0.25448158383369446,-0.09890332818031311,-0.15848082304000854,-0.410362184047699,0.2619783282279968,0.26546573638916016,0.16242936253547668,0.05657510831952095,-0.3520739674568176,-0.0031121671199798584,0.03943334519863129,0.13242168724536896,-0.328250527381897,0.165659561753273,0.1394447386264801,-0.351899653673172,-0.2938770651817322,-0.09546080976724625,0.00857698917388916,0.1816222369670868,0.11999250948429108,0.8653561472892761,-0.3382751941680908,0.38677093386650085,0.016493720933794975,-0.14619790017604828,0.1982942819595337,0.21471187472343445,-0.43139463663101196,0.13166318833827972,0.2818213105201721,0.21845249831676483,0.1474643349647522,-0.41207948327064514,-0.2518366873264313,0.4045863151550293,-0.26536551117897034,0.5604444742202759,-0.48334234952926636,0.06296315044164658,-0.07976306229829788,0.28009703755378723,0.5879046320915222,-0.465137779712677,0.5916157960891724,-0.11475670337677002,0.3825489282608032,-0.20195768773555756,0.24714630842208862,-0.5060781836509705,0.22733624279499054,0.11602246761322021,0.3956139087677002,0.21514572203159332,-0.4767588675022125,-0.5376874208450317,-0.07428896427154541,-0.0838572159409523,-0.42111510038375854,0.2784755527973175,0.08654952794313431,0.7979721426963806,-0.4041674733161926,-0.4097672700881958,0.3066725432872772,0.09854064881801605,0.6610888838768005,-0.0075028687715530396,0.176660418510437,0.1454736888408661,0.3884231150150299,-0.18586105108261108,-0.30105167627334595,-0.1934349089860916,0.2731369137763977,-0.37817105650901794,-0.3154723644256592,0.35008862614631653,-0.40227580070495605,0.09264561533927917,1.6945100776672644e-32,-0.5809197425842285,-0.3158588707447052,0.2626440227031708,0.19387921690940857,0.5373632311820984,-0.1566801369190216,0.6362246870994568,0.48566681146621704,0.021669909358024597,-0.005965720862150192,-0.27631375193595886,-0.3439052104949951,0.04319934546947479,-0.19030526280403137,0.39548224210739136,0.0588795468211174,0.09744586050510406,0.6568045616149902,0.07950230687856674,0.08366429805755615,0.20543691515922546,0.32713237404823303,0.32618921995162964,0.2098175287246704,-0.5404307246208191,0.04800139367580414,-0.4378911554813385,-0.17230910062789917,-0.06506655365228653,0.06480143964290619,-0.05009268969297409,0.014947365038096905,-0.41906100511550903,0.03272956609725952,-0.3539600074291229,0.1313663274049759,-0.07444728910923004,0.6056205034255981,-0.5029509663581848,0.018588703125715256,0.03206132352352142,-0.4104134142398834,-0.05124015733599663,-0.26040294766426086,0.2024395912885666,-0.06571437418460846,0.4655287563800812,-0.12388091534376144,-0.30205848813056946,0.2326444536447525,-0.5091665387153625,-0.47150668501853943,0.030468156561255455,0.2572106719017029,0.5434388518333435,-0.4829779863357544,0.3201858699321747,0.0038664229214191437,-0.2850993573665619,-0.00847277045249939,-0.2557584047317505,0.3207301199436188,-0.573981761932373,0.5897049903869629,0.14977404475212097,0.3972458243370056,-0.5134406685829163,0.1545073539018631,-0.5221650004386902,0.19342483580112457,-0.5961824655532837,-0.1837753802537918,-0.4865763485431671,-0.08547752350568771,-0.1319717913866043,-0.11161406338214874,-0.2434302568435669,0.8339599370956421,-0.1542665809392929,-0.4087808132171631,0.5070624947547913,0.4983042776584625,-0.14277350902557373,-0.16409988701343536,-0.09650298953056335,0.2674719989299774,0.18236331641674042,-0.5096426010131836,-0.14792539179325104,0.028363369405269623,-0.3926340341567993,-0.33052027225494385,0.18018130958080292,0.41283100843429565,-0.07674133032560349,-9.344856977122618e-8,0.36824432015419006,-0.3715684115886688,0.08675776422023773,-0.16826604306697845,-0.1812802255153656,0.25118333101272583,0.09312999248504639,0.011199267581105232,0.03963886573910713,0.08714527636766434,-0.20642665028572083,-0.058172207325696945,0.39452189207077026,0.2506520748138428,-0.32217463850975037,0.20743203163146973,0.5841588973999023,-0.13370975852012634,-0.24672745168209076,0.3648327589035034,-0.20949557423591614,-0.3930029571056366,-0.18244031071662903,0.46257802844047546,-0.18827395141124725,-0.13595683872699738,-0.2050124853849411,-0.26170676946640015,0.25242772698402405,-0.12149323523044586,0.26204097270965576,-0.2683183550834656,-0.0023540835827589035,0.8447559475898743,-0.30421972274780273,-0.1943383663892746,0.3394404649734497,-0.19386941194534302,-1.1547374725341797,-0.13543672859668732,-0.3759058713912964,0.27509501576423645,0.3770904242992401,0.43903088569641113,0.0838296189904213,-0.27174776792526245,0.46335771679878235,-0.4414387047290802,0.33163267374038696,-0.37141963839530945,0.4407504200935364,0.05923306196928024,0.12760603427886963,0.3313932716846466,-0.0378437414765358,0.7977135181427002,-0.2784639596939087,-0.5062952041625977,-0.42126479744911194,0.3309297263622284,0.2543199062347412,-0.11929052323102951,0.10146140307188034,0.510850191116333]
    ],
  "ids": [
    "0"
  ]
}'
```
Get 10 most similar documents from a given embedding:
```
curl -X 'POST' \
  'http://localhost:8000/api/v1/collections/45c8f2f4-b89e-42ee-91aa-bfcb3569efe8/query' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "query_embeddings":[
    [-0.24474170804023743,-0.15710097551345825,0.16889514029026031,-0.14032849669456482,-0.18645115196704865,-0.5746803283691406,0.6454887390136719,0.2457900047302246,0.3479900658130646,-0.5019916892051697,-0.1712668538093567,-0.2223372459411621,0.25071778893470764,0.3728926181793213,0.10597996413707733,-0.052072860300540924,0.46144598722457886,0.12275993824005127,-0.050792329013347626,-0.22798608243465424,-0.26064831018447876,-0.3273683190345764,0.23064151406288147,-0.008950365707278252,-0.2373257875442505,-0.02786778286099434,0.14122235774993896,0.20905067026615143,0.17631950974464417,-0.7102054357528687,0.6785212755203247,0.47669142484664917,-0.24170780181884766,-0.1651581972837448,-0.1657567173242569,0.2234247326850891,0.49723291397094727,0.19169020652770996,-0.04689759761095047,0.7749730944633484,-0.030774656683206558,0.17086069285869598,-0.002803310751914978,-0.40139538049697876,-0.32342803478240967,-0.49097782373428345,-0.038890399038791656,-0.38480061292648315,0.018401585519313812,0.17538264393806458,-0.10832764208316803,-0.7694277167320251,-0.11541437357664108,-0.0302397683262825,-0.0262732096016407,0.16772514581680298,0.21310792863368988,0.48245757818222046,0.25874364376068115,-0.32430729269981384,0.0273447148501873,0.36556580662727356,0.05915079265832901,0.16762229800224304,-0.034875672310590744,-0.3423530161380768,-0.08328642696142197,-0.16205666959285736,-0.24838456511497498,-0.04844600707292557,0.16937987506389618,0.040141236037015915,0.222842738032341,0.35240185260772705,-0.4546525478363037,0.3537089228630066,-0.059628039598464966,-0.3035477101802826,0.1213773638010025,0.13187500834465027,0.4986896514892578,-0.28238028287887573,-0.03542700037360191,-0.27965405583381653,0.20894742012023926,-0.43395280838012695,-0.5373532772064209,0.1242600604891777,0.3522739112377167,-0.1963927000761032,-0.06320372968912125,0.3233725428581238,-0.37356820702552795,0.19930796325206757,-0.23292112350463867,0.008522462099790573,0.4767061769962311,-0.015705358237028122,-0.8169814348220825,0.8335546851158142,0.024698123335838318,-0.1288551241159439,-0.29477906227111816,0.6603707671165466,0.1129225417971611,-0.2850611209869385,0.4679226577281952,-0.13059288263320923,-0.1510632336139679,-0.13538718223571777,-0.12687860429286957,0.3043046295642853,0.34894371032714844,-0.2742483913898468,0.2748413383960724,-0.09523925185203552,0.19183480739593506,0.6545851230621338,-0.2958841323852539,-0.2748139202594757,0.19183611869812012,0.4745813310146332,-0.2935122847557068,-0.1278952956199646,-0.09456666558980942,0.2159797102212906,0.3216647207736969,-1.282921163239204e-32,0.11274350434541702,0.08271454274654388,0.0622611939907074,-0.22339513897895813,0.48307326436042786,-0.27442434430122375,-0.22550396621227264,-0.17769528925418854,-0.3112220764160156,-0.38759535551071167,-0.11696912348270416,-0.4370594918727875,-0.626888632774353,-0.06789357960224152,0.31318411231040955,0.1260882318019867,-0.09310894459486008,-0.11529692262411118,-0.4102232754230499,0.020973842591047287,0.06089121103286743,0.3184308409690857,0.21258103847503662,0.6669488549232483,0.052028998732566833,0.19459867477416992,0.4652068316936493,-0.35241514444351196,0.1103876456618309,0.11731885373592377,0.17901983857154846,0.1124039888381958,-0.1562931388616562,-0.08640387654304504,-0.2976609170436859,-0.13741183280944824,-0.7263472080230713,-0.5496900081634521,-0.25763848423957825,0.14259403944015503,-0.10915719717741013,-0.26984137296676636,0.02225564792752266,0.20054714381694794,0.13516627252101898,0.1823287308216095,0.0339847169816494,0.5359187126159668,0.9782767295837402,-0.6039113402366638,0.049121543765068054,0.11074082553386688,-0.6057475209236145,0.6412453651428223,-0.3213413953781128,0.280063271522522,-0.24357105791568756,-0.36315906047821045,0.4873881936073303,0.20860308408737183,-0.21794208884239197,-0.16761702299118042,0.5031269192695618,-0.3337961435317993,-0.3006102740764618,-0.15589049458503723,-0.3592815399169922,0.2559988796710968,0.1367335170507431,0.30812546610832214,-0.17098824679851532,-0.015316465869545937,-0.2926582992076874,0.21306456625461578,0.2344980537891388,-0.3104139566421509,0.6288824677467346,-0.3175372779369354,0.17905446887016296,-0.43430110812187195,-0.034773580729961395,-0.14443939924240112,0.532122015953064,-0.2983599603176117,0.0967978686094284,-0.19285008311271667,-0.3407741189002991,-0.08450236171483994,0.09485785663127899,0.3542555570602417,-0.2684316039085388,-0.5222052335739136,0.006494848057627678,-0.3192369341850281,-0.7555625438690186,1.6055580691518403e-32,-0.03618427366018295,-0.024993816390633583,0.38703644275665283,0.12548893690109253,-0.3950032889842987,-0.1696144938468933,-0.9099017977714539,0.5201564431190491,0.08297677338123322,0.10831055045127869,-0.40154242515563965,-0.10150241106748581,0.2182786762714386,-0.05964144319295883,0.05517237260937691,0.27564895153045654,0.18456372618675232,-0.07162311673164368,0.24978958070278168,-0.23446409404277802,0.28622689843177795,0.09672275185585022,-0.311223566532135,-0.13790257275104523,0.015063565224409103,0.2413410097360611,-0.2959720492362976,0.18353591859340668,-0.24770452082157135,0.2565746307373047,0.14476266503334045,-0.09952821582555771,-0.2974964380264282,-0.5615485906600952,0.15818926692008972,0.4875912070274353,0.16337339580059052,0.17480626702308655,-0.23139025270938873,0.1527530997991562,-0.3379966616630554,-0.001726355403661728,0.2494111955165863,0.4885110855102539,0.17644308507442474,0.40196508169174194,-0.15868429839611053,-0.06597597151994705,0.14097154140472412,0.12357796728610992,-0.5248677730560303,0.2096269279718399,-0.1397939920425415,-0.16190317273139954,0.13045206665992737,-0.16071639955043793,-0.06858396530151367,-0.137283593416214,-0.17715485394001007,-0.5132940411567688,0.07880343496799469,0.07416055351495743,-0.36686229705810547,0.007493969053030014,0.4163888096809387,0.38266244530677795,-0.038559749722480774,-0.17981106042861938,-0.1707255095243454,-0.2902900278568268,-0.6005701422691345,-0.08739934861660004,-0.5501750111579895,-0.18694129586219788,0.4578508734703064,-0.23037999868392944,-0.3400184214115143,0.49517911672592163,0.08525396138429642,0.04212096333503723,0.14553973078727722,0.2941879630088806,-0.22580337524414062,-0.223981574177742,0.2791958749294281,0.5308837890625,-0.04007897526025772,0.2163066267967224,0.40084168314933777,-0.1099889874458313,0.020616261288523674,0.17633414268493652,0.11117374897003174,-0.3308742344379425,0.6068921089172363,-9.378327803233333e-8,-0.12084484100341797,-0.22189967334270477,-0.15547315776348114,-0.38094010949134827,0.29288336634635925,0.23210328817367554,-0.3978614807128906,-0.012349462136626244,-0.07555599510669708,0.27120545506477356,0.36016127467155457,0.18691156804561615,-0.1806442141532898,0.10823585838079453,0.3113362491130829,0.6608915328979492,0.33498331904411316,-0.12330687791109085,-0.02384619042277336,0.194847971200943,0.10193060338497162,0.39980995655059814,0.2600231468677521,0.6530919075012207,0.10349404811859131,0.22288163006305695,-0.2561643123626709,0.24688583612442017,0.13910485804080963,0.4336695373058319,0.18341006338596344,0.4687558114528656,0.21593531966209412,-0.06978850066661835,0.06935025006532669,0.2854984700679779,-0.09173959493637085,0.14450256526470184,-0.0871991366147995,-0.11436495929956436,0.017323605716228485,0.04224853217601776,0.495921790599823,-0.07722828537225723,-0.34579193592071533,-0.09096752852201462,-0.10709525644779205,-0.04203816503286362,0.2825544476509094,-0.018734313547611237,-0.2073010504245758,-0.3693670928478241,0.26278796792030334,0.6313356161117554,0.061717838048934937,-0.5161221623420715,-0.2664838433265686,-0.4657774865627289,-0.02934626303613186,-0.4273797869682312,0.5020259618759155,-0.16420228779315948,0.7481613159179688,-0.4454364478588104]
    ],
  "n_results": 10,
  "include": [
    "metadatas",
    "documents",
    "distances"
  ]
}'
```